# grpcstore

Minimal Go gRPC e-commerce store service with a server and client, fully containerized with Docker.

This project demonstrates a complete end-to-end gRPC application, including:

- API definition using **Protocol Buffers (.proto)**
- Server and client implementations in **Go**
- Multi-stage minimal **Docker** builds
- Orchestration with **Docker Compose** for full E2E testing

---

## Prerequisites

Make sure you have the following installed:

- **Go** (1.25+ recommended)
- **protoc** — Protocol Buffer Compiler
- **Docker** & **Docker Compose**

---

## Quick Start (Recommended: Docker Compose)

This is the easiest and most reliable way to run the full application.  
Docker Compose builds both images, runs the server, and executes the client's E2E tests.

From the project root:

```sh
# Build the images and run the full E2E test suite
docker compose up --build --exit-code-from client
````

To clean everything up:

```sh
docker compose down
```

---

## Local Development

If you prefer to run the server and client locally on your system.

---

### 1. Install Go Plugins

Run once:

```sh
go install google.golang.org/protobuf/cmd/protoc-gen-go@latest
go install google.golang.org/grpc/cmd/protoc-gen-go-grpc@latest
```

---

### 2. Generate Protobuf Code

Run this whenever you modify `store.proto`:

```sh
protoc --go_out=./storeproto --go_opt=paths=source_relative \
       --go-grpc_out=./storeproto --go-grpc_opt=paths=source_relative \
       store.proto
```

This generates code inside the `storeproto/` directory.

---

### 3. Run the Server

```sh
# Server starts on port 6767
go run ./cmd/server
```

---

### 4. Run the Client (E2E Test)

In a separate terminal:

```powershell
$env:SERVER_ADDR="localhost:6767"; go run ./cmd/client
```

---

## Project Structure

```
.
├── cmd/
│   ├── client/
│   │   └── main.go              # Client entrypoint
│   └── server/
│       └── main.go              # Server entrypoint
│
├── storeproto/
│   ├── store.pb.go              # Generated by protoc
│   └── store_grpc.pb.go         # Generated by protoc
│
├── .dockerignore
├── .gitignore
├── Dockerfile.client            # Client Docker build
├── Dockerfile.server            # Server Docker build
├── docker-compose.yml           # Server + client orchestration
├── go.mod
├── go.sum
├── README.md
└── store.proto                  # API source definition